2025-08-14 12:09:22,989 - INFO - Initializing Code Summarizer...
2025-08-14 12:09:23,296 - INFO - Using device: cuda
2025-08-14 12:09:23,297 - INFO - Apply quantization
2025-08-14 12:09:23,297 - INFO - Using 8-bit quantization
2025-08-14 12:09:23,297 - INFO - Loading tokenizer: meta-llama/Llama-3.1-8B-Instruct
2025-08-14 12:09:25,057 - INFO - Loading model: meta-llama/Llama-3.1-8B-Instruct
2025-08-14 12:11:48,523 - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]/NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.13/site-packages/torch/utils/cpp_extension.py:2356: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Loading checkpoint shards:  25%|██▌       | 1/4 [05:28<16:24, 328.23s/it]Loading checkpoint shards:  50%|█████     | 2/4 [05:30<04:33, 136.63s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [05:33<01:15, 75.39s/it] Loading checkpoint shards: 100%|██████████| 4/4 [05:33<00:00, 45.83s/it]Loading checkpoint shards: 100%|██████████| 4/4 [05:33<00:00, 83.44s/it]
2025-08-14 12:17:25,227 - INFO - Model loaded successfully
2025-08-14 12:17:25,227 - INFO - Loading datasets...
2025-08-14 12:17:25,340 - INFO - Loaded 5183 examples from /NFSHOME/gdaloisio/code/CodeXGLUE/Code-Text/code-to-text/dataset/java/valid.jsonl
2025-08-14 12:17:25,603 - INFO - Loaded 10955 examples from /NFSHOME/gdaloisio/code/CodeXGLUE/Code-Text/code-to-text/dataset/java/test.jsonl
2025-08-14 12:17:25,603 - INFO - Using 3 few-shot examples
2025-08-14 12:17:26,364 - INFO - Starting evaluation...
Size (MB): 16060.52
Generating summaries:   0%|          | 0/10955 [00:00<?, ?it/s]Generating summaries:   0%|          | 1/10955 [00:06<20:42:53,  6.81s/it]Generating summaries:   0%|          | 2/10955 [00:13<20:21:24,  6.69s/it]Generating summaries:   0%|          | 3/10955 [00:20<20:18:24,  6.68s/it]Generating summaries:   0%|          | 4/10955 [00:26<20:17:26,  6.67s/it]Generating summaries:   0%|          | 5/10955 [00:33<20:09:36,  6.63s/it]Generating summaries:   0%|          | 6/10955 [00:39<20:02:28,  6.59s/it]Generating summaries:   0%|          | 7/10955 [00:45<18:57:50,  6.24s/it]Generating summaries:   0%|          | 8/10955 [00:50<18:07:41,  5.96s/it]Generating summaries:   0%|          | 9/10955 [00:56<17:40:38,  5.81s/it]2025-08-14 12:18:28,141 - INFO - Processed 10/10955 samples. Est. remaining time: 1126.9min
Generating summaries:   0%|          | 10/10955 [01:01<17:28:36,  5.75s/it]Generating summaries:   0%|          | 11/10955 [01:07<17:07:43,  5.63s/it]Generating summaries:   0%|          | 12/10955 [01:12<16:57:56,  5.58s/it]Generating summaries:   0%|          | 13/10955 [01:18<16:50:49,  5.54s/it]Generating summaries:   0%|          | 14/10955 [01:23<16:58:58,  5.59s/it]Generating summaries:   0%|          | 15/10955 [01:29<16:50:52,  5.54s/it]Generating summaries:   0%|          | 16/10955 [01:34<16:45:21,  5.51s/it]Generating summaries:   0%|          | 17/10955 [01:40<16:41:20,  5.49s/it]Generating summaries:   0%|          | 18/10955 [01:45<16:48:21,  5.53s/it]Generating summaries:   0%|          | 19/10955 [01:51<17:03:42,  5.62s/it]2025-08-14 12:19:23,596 - INFO - Processed 20/10955 samples. Est. remaining time: 1068.3min
Generating summaries:   0%|          | 20/10955 [01:57<17:08:28,  5.64s/it]Generating summaries:   0%|          | 21/10955 [02:02<16:53:35,  5.56s/it]Generating summaries:   0%|          | 22/10955 [02:08<16:47:13,  5.53s/it]Generating summaries:   0%|          | 23/10955 [02:14<17:13:37,  5.67s/it]Generating summaries:   0%|          | 24/10955 [02:19<17:17:21,  5.69s/it]Generating summaries:   0%|          | 25/10955 [02:25<17:11:44,  5.66s/it]Generating summaries:   0%|          | 26/10955 [02:30<17:03:05,  5.62s/it]Generating summaries:   0%|          | 27/10955 [02:36<17:02:44,  5.62s/it]Generating summaries:   0%|          | 28/10955 [02:43<17:59:46,  5.93s/it]Generating summaries:   0%|          | 29/10955 [02:49<18:33:11,  6.11s/it]2025-08-14 12:20:21,557 - INFO - Processed 30/10955 samples. Est. remaining time: 1063.3min
Generating summaries:   0%|          | 30/10955 [02:55<17:57:58,  5.92s/it]Generating summaries:   0%|          | 31/10955 [03:01<17:56:31,  5.91s/it]Generating summaries:   0%|          | 32/10955 [03:06<17:42:08,  5.83s/it]Generating summaries:   0%|          | 33/10955 [03:12<17:17:56,  5.70s/it]Generating summaries:   0%|          | 34/10955 [03:17<17:16:45,  5.70s/it]Generating summaries:   0%|          | 35/10955 [03:24<18:05:23,  5.96s/it]Generating summaries:   0%|          | 36/10955 [03:31<18:40:30,  6.16s/it]Generating summaries:   0%|          | 37/10955 [03:37<19:05:27,  6.29s/it]Generating summaries:   0%|          | 38/10955 [03:44<19:40:24,  6.49s/it]Generating summaries:   0%|          | 39/10955 [03:51<19:55:16,  6.57s/it]2025-08-14 12:21:23,545 - INFO - Processed 40/10955 samples. Est. remaining time: 1078.7min
Generating summaries:   0%|          | 40/10955 [03:57<19:16:04,  6.35s/it]Generating summaries:   0%|          | 41/10955 [04:02<18:26:41,  6.08s/it]Generating summaries:   0%|          | 42/10955 [04:08<17:56:35,  5.92s/it]Generating summaries:   0%|          | 43/10955 [04:13<17:32:20,  5.79s/it]Generating summaries:   0%|          | 44/10955 [04:19<17:14:39,  5.69s/it]Generating summaries:   0%|          | 45/10955 [04:24<17:05:50,  5.64s/it]Generating summaries:   0%|          | 46/10955 [04:30<16:56:27,  5.59s/it]Generating summaries:   0%|          | 47/10955 [04:35<16:49:16,  5.55s/it]Generating summaries:   0%|          | 48/10955 [04:41<17:08:22,  5.66s/it]Generating summaries:   0%|          | 49/10955 [04:47<17:09:56,  5.67s/it]2025-08-14 12:22:19,085 - INFO - Processed 50/10955 samples. Est. remaining time: 1064.0min
Generating summaries:   0%|          | 50/10955 [04:52<17:04:04,  5.63s/it]Generating summaries:   0%|          | 51/10955 [04:58<17:03:10,  5.63s/it]Generating summaries:   0%|          | 52/10955 [05:03<16:59:48,  5.61s/it]Generating summaries:   0%|          | 53/10955 [05:09<16:53:30,  5.58s/it]Generating summaries:   0%|          | 54/10955 [05:15<17:10:54,  5.67s/it]Generating summaries:   1%|          | 55/10955 [05:21<17:36:19,  5.81s/it]Generating summaries:   1%|          | 56/10955 [05:27<18:08:06,  5.99s/it]Generating summaries:   1%|          | 57/10955 [05:33<18:09:04,  6.00s/it]Generating summaries:   1%|          | 58/10955 [05:39<17:44:16,  5.86s/it]Generating summaries:   1%|          | 59/10955 [05:45<17:51:20,  5.90s/it]2025-08-14 12:23:17,337 - INFO - Processed 60/10955 samples. Est. remaining time: 1062.2min
