No CUDA runtime is found, using CUDA_HOME='/usr/local/cuda'
07/17/2024 11:00:01 - INFO - __main__ -   Namespace(model_type='roberta', model_name_or_path='microsoft/codebert-base', output_dir='model/java', load_model_path='model/java/checkpoint-best-bleu/pytorch_model.bin', train_filename=None, dev_filename=None, test_filename='../dataset/java/test.jsonl', config_name='', tokenizer_name='', max_source_length=256, max_target_length=128, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=True, quantize=False, quantize4=False, quantizef8=False, prune=True, prune4=False, prune6=False, do_retrain=False, train_batch_size=8, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=3, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=0, local_rank=-1, seed=42, job_id='17036', file_len=300)
07/17/2024 11:00:01 - WARNING - __main__ -   Process rank: -1, device: cpu, n_gpu: 2, distributed training: False
07/17/2024 11:00:06 - INFO - __main__ -   reload model from model/java/checkpoint-best-bleu/pytorch_model.bin
07/17/2024 11:00:11 - INFO - __main__ -   Apply model pruning
Traceback (most recent call last):
  File "/NFSHOME/gdaloisio/code/CodeXGLUE/Code-Text/code-to-text/code/run.py", line 887, in <module>
    main()
  File "/NFSHOME/gdaloisio/code/CodeXGLUE/Code-Text/code-to-text/code/run.py", line 717, in main
    (model.dense, "weight"),
  File "/NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'DataParallel' object has no attribute 'dense'
srun: error: compute-0-3: task 0: Exited with exit code 1
