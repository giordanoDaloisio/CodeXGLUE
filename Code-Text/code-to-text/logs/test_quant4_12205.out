07/17/2024 01:07:35 - INFO - __main__ -   Namespace(model_type='roberta', model_name_or_path='microsoft/codebert-base', output_dir='model/java', load_model_path='model/java/checkpoint-best-bleu/pytorch_model.bin', train_filename=None, dev_filename=None, test_filename='../dataset/java/test.jsonl', config_name='', tokenizer_name='', max_source_length=256, max_target_length=128, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=True, quantize=False, quantize4=True, quantizef8=False, prune=False, prune4=False, prune6=False, do_retrain=False, train_batch_size=8, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=3, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=0, local_rank=-1, seed=42, job_id='12205', file_len=300)
07/17/2024 01:07:35 - WARNING - __main__ -   Process rank: -1, device: cpu, n_gpu: 0, distributed training: False
07/17/2024 01:07:43 - INFO - __main__ -   reload model from model/java/checkpoint-best-bleu/pytorch_model.bin
07/17/2024 01:07:53 - INFO - __main__ -   Apply quantization qint4
07/17/2024 01:07:58 - INFO - __main__ -   ******* Calibration **************
  0%|          | 0/172 [00:00<?, ?it/s]/NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ops.py:66: UserWarning: An exception was raised while calling the optimized kernel for quanto::unpack: Error building extension 'quanto_cpp': [1/3] c++ -MMD -MF unpack.o.d -DTORCH_EXTENSION_NAME=quanto_cpp -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/TH -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/THC -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++17 -O3 -c /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/unpack.cpp -o unpack.o 
FAILED: unpack.o 
c++ -MMD -MF unpack.o.d -DTORCH_EXTENSION_NAME=quanto_cpp -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/TH -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/THC -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++17 -O3 -c /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/unpack.cpp -o unpack.o 
In file included from /opt/ohpc/pub/compiler/gcc/12.3.0/include/c++/12.3.0/x86_64-pc-linux-gnu/bits/c++config.h:655,
                 from /opt/ohpc/pub/compiler/gcc/12.3.0/include/c++/12.3.0/cstddef:49,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/c10/core/DeviceType.h:10,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/c10/core/Device.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:11,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/ATen/core/Tensor.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/ATen/Tensor.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/extension.h:5,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/unpack.h:15,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/unpack.cpp:15:
/opt/ohpc/pub/compiler/gcc/12.3.0/include/c++/12.3.0/x86_64-pc-linux-gnu/bits/os_defines.h:39:10: fatal error: features.h: No such file or directory
   39 | #include <features.h>
      |          ^~~~~~~~~~~~
compilation terminated.
[2/3] c++ -MMD -MF pybind_module.o.d -DTORCH_EXTENSION_NAME=quanto_cpp -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/TH -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/THC -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++17 -O3 -c /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/pybind_module.cpp -o pybind_module.o 
FAILED: pybind_module.o 
c++ -MMD -MF pybind_module.o.d -DTORCH_EXTENSION_NAME=quanto_cpp -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/TH -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/THC -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++17 -O3 -c /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/pybind_module.cpp -o pybind_module.o 
In file included from /opt/ohpc/pub/compiler/gcc/12.3.0/include/c++/12.3.0/x86_64-pc-linux-gnu/bits/c++config.h:655,
                 from /opt/ohpc/pub/compiler/gcc/12.3.0/include/c++/12.3.0/cstddef:49,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/c10/core/DeviceType.h:10,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/c10/core/Device.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:11,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/ATen/core/Tensor.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/ATen/Tensor.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/extension.h:5,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/pybind_module.cpp:15:
/opt/ohpc/pub/compiler/gcc/12.3.0/include/c++/12.3.0/x86_64-pc-linux-gnu/bits/os_defines.h:39:10: fatal error: features.h: No such file or directory
   39 | #include <features.h>
      |          ^~~~~~~~~~~~
compilation terminated.
ninja: build stopped: subcommand failed.
 Falling back to default implementation.
  warnings.warn(message + " Falling back to default implementation.")
/NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ops.py:66: UserWarning: An exception was raised while calling the optimized kernel for quanto::unpack: /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/build/quanto_cpp.so: cannot open shared object file: No such file or directory Falling back to default implementation.
  warnings.warn(message + " Falling back to default implementation.")
