07/15/2024 22:18:38 - INFO - __main__ -   Namespace(model_type='roberta', model_name_or_path='microsoft/codebert-base', output_dir='model/java', load_model_path='model/java/checkpoint-best-bleu/pytorch_model.bin', train_filename=None, dev_filename=None, test_filename='../dataset/java/test.jsonl', config_name='', tokenizer_name='', max_source_length=256, max_target_length=128, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, quantize=False, quantize4=False, quantizef8=False, prune=True, prune4=False, prune6=False, train_batch_size=8, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=3, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=0, local_rank=-1, seed=42, job_id='17031', file_len=300)
07/15/2024 22:18:38 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False
07/15/2024 22:18:45 - INFO - __main__ -   reload model from model/java/checkpoint-best-bleu/pytorch_model.bin
07/15/2024 22:18:54 - INFO - __main__ -   Apply model pruning
07/15/2024 22:18:58 - INFO - __main__ -   Size (MB): 706.893086
07/15/2024 22:18:59 - INFO - __main__ -   Test file: ../dataset/java/test.jsonl
  0%|          | 0/172 [00:00<?, ?it/s]/NFSHOME/gdaloisio/code/CodeXGLUE/Code-Text/code-to-text/code/model.py:114: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  self.scores = self.tt.FloatTensor(size).zero_()
  1%|          | 1/172 [00:39<1:52:59, 39.64s/it]  1%|          | 2/172 [01:07<1:32:15, 32.56s/it]  2%|▏         | 3/172 [01:32<1:22:54, 29.43s/it]  2%|▏         | 4/172 [02:02<1:22:23, 29.42s/it]  3%|▎         | 5/172 [02:31<1:21:32, 29.29s/it]  3%|▎         | 6/172 [03:00<1:21:06, 29.32s/it]  4%|▍         | 7/172 [03:29<1:19:44, 29.00s/it]  5%|▍         | 8/172 [03:55<1:16:34, 28.01s/it]  5%|▌         | 9/172 [04:21<1:14:27, 27.41s/it]  6%|▌         | 10/172 [04:45<1:11:40, 26.54s/it]  6%|▋         | 11/172 [05:09<1:08:54, 25.68s/it]  7%|▋         | 12/172 [05:35<1:08:39, 25.75s/it]  8%|▊         | 13/172 [06:00<1:07:40, 25.54s/it]  8%|▊         | 14/172 [06:26<1:07:19, 25.57s/it]  9%|▊         | 15/172 [06:51<1:06:43, 25.50s/it]  9%|▉         | 16/172 [07:15<1:05:06, 25.04s/it] 10%|▉         | 17/172 [07:42<1:05:57, 25.53s/it] 10%|█         | 18/172 [08:07<1:05:25, 25.49s/it] 11%|█         | 19/172 [08:31<1:04:10, 25.17s/it] 12%|█▏        | 20/172 [08:56<1:03:07, 24.92s/it] 12%|█▏        | 21/172 [09:20<1:02:09, 24.70s/it] 13%|█▎        | 22/172 [09:44<1:01:14, 24.50s/it] 13%|█▎        | 23/172 [10:09<1:01:37, 24.81s/it] 14%|█▍        | 24/172 [10:35<1:02:06, 25.18s/it] 15%|█▍        | 25/172 [10:59<1:00:42, 24.78s/it] 15%|█▌        | 26/172 [11:25<1:00:44, 24.96s/it] 16%|█▌        | 27/172 [11:50<1:00:34, 25.07s/it] 16%|█▋        | 28/172 [12:15<1:00:19, 25.14s/it] 17%|█▋        | 29/172 [12:41<1:00:08, 25.24s/it] 17%|█▋        | 30/172 [13:06<59:38, 25.20s/it]   18%|█▊        | 31/172 [13:33<1:00:17, 25.66s/it] 19%|█▊        | 32/172 [14:02<1:02:20, 26.72s/it] 19%|█▉        | 33/172 [14:31<1:03:26, 27.38s/it] 20%|█▉        | 34/172 [14:57<1:01:54, 26.92s/it] 20%|██        | 35/172 [15:24<1:01:42, 27.03s/it] 21%|██        | 36/172 [15:50<1:00:55, 26.88s/it] 22%|██▏       | 37/172 [16:18<1:01:01, 27.13s/it] 22%|██▏       | 38/172 [16:43<59:16, 26.54s/it]   23%|██▎       | 39/172 [17:10<59:12, 26.71s/it] 23%|██▎       | 40/172 [17:36<58:01, 26.37s/it] 24%|██▍       | 41/172 [18:05<59:08, 27.09s/it] 24%|██▍       | 42/172 [18:32<58:54, 27.19s/it] 25%|██▌       | 43/172 [18:59<58:06, 27.03s/it] 26%|██▌       | 44/172 [19:24<56:09, 26.33s/it] 26%|██▌       | 45/172 [19:50<55:55, 26.42s/it] 27%|██▋       | 46/172 [20:18<56:15, 26.79s/it] 27%|██▋       | 47/172 [20:42<54:11, 26.01s/it] 28%|██▊       | 48/172 [21:07<53:07, 25.71s/it] 28%|██▊       | 49/172 [21:32<52:26, 25.58s/it] 29%|██▉       | 50/172 [21:58<52:19, 25.73s/it] 30%|██▉       | 51/172 [22:23<50:57, 25.27s/it] 30%|███       | 52/172 [22:53<53:23, 26.69s/it] 31%|███       | 53/172 [23:20<53:20, 26.90s/it] 31%|███▏      | 54/172 [23:47<53:05, 26.99s/it] 32%|███▏      | 55/172 [24:14<52:39, 27.01s/it] 33%|███▎      | 56/172 [24:41<52:05, 26.95s/it] 33%|███▎      | 57/172 [25:10<52:32, 27.41s/it] 34%|███▎      | 58/172 [25:35<51:05, 26.89s/it] 34%|███▍      | 59/172 [26:00<49:16, 26.16s/it] 35%|███▍      | 60/172 [26:24<47:32, 25.47s/it] 35%|███▌      | 61/172 [26:46<45:31, 24.61s/it] 36%|███▌      | 62/172 [27:08<43:45, 23.87s/it] 37%|███▋      | 63/172 [27:33<43:46, 24.10s/it] 37%|███▋      | 64/172 [27:59<44:35, 24.77s/it] 38%|███▊      | 65/172 [28:27<45:39, 25.61s/it] 38%|███▊      | 66/172 [28:52<45:07, 25.54s/it] 39%|███▉      | 67/172 [29:17<44:28, 25.42s/it] 40%|███▉      | 68/172 [29:45<45:17, 26.13s/it] 40%|████      | 69/172 [30:10<44:09, 25.73s/it] 41%|████      | 70/172 [30:39<45:21, 26.68s/it] 41%|████▏     | 71/172 [31:08<46:13, 27.46s/it] 42%|████▏     | 72/172 [31:34<45:11, 27.11s/it] 42%|████▏     | 73/172 [32:08<47:46, 28.95s/it] 43%|████▎     | 74/172 [32:34<45:52, 28.09s/it] 44%|████▎     | 75/172 [32:59<44:06, 27.28s/it] 44%|████▍     | 76/172 [33:25<43:03, 26.91s/it] 45%|████▍     | 77/172 [33:55<43:56, 27.75s/it] 45%|████▌     | 78/172 [34:22<43:03, 27.48s/it] 46%|████▌     | 79/172 [34:46<41:18, 26.65s/it] 47%|████▋     | 80/172 [35:13<41:02, 26.77s/it] 47%|████▋     | 81/172 [35:40<40:23, 26.64s/it] 48%|████▊     | 82/172 [36:05<39:18, 26.21s/it] 48%|████▊     | 83/172 [36:32<39:13, 26.44s/it] 49%|████▉     | 84/172 [37:00<39:34, 26.98s/it] 49%|████▉     | 85/172 [37:29<39:51, 27.48s/it] 50%|█████     | 86/172 [38:01<41:33, 29.00s/it] 51%|█████     | 87/172 [38:29<40:41, 28.72s/it] 51%|█████     | 88/172 [38:55<39:03, 27.90s/it] 52%|█████▏    | 89/172 [39:23<38:21, 27.73s/it] 52%|█████▏    | 90/172 [39:49<37:13, 27.24s/it] 53%|█████▎    | 91/172 [40:19<37:57, 28.12s/it] 53%|█████▎    | 92/172 [40:45<36:35, 27.45s/it] 54%|█████▍    | 93/172 [41:12<35:56, 27.30s/it] 55%|█████▍    | 94/172 [41:38<34:55, 26.86s/it] 55%|█████▌    | 95/172 [42:02<33:26, 26.06s/it] 56%|█████▌    | 96/172 [42:26<32:13, 25.45s/it] 56%|█████▋    | 97/172 [42:52<32:09, 25.73s/it] 57%|█████▋    | 98/172 [43:23<33:25, 27.10s/it] 58%|█████▊    | 99/172 [43:50<33:09, 27.25s/it] 58%|█████▊    | 100/172 [44:14<31:17, 26.07s/it] 59%|█████▊    | 101/172 [44:37<29:57, 25.32s/it] 59%|█████▉    | 102/172 [45:02<29:23, 25.19s/it] 60%|█████▉    | 103/172 [45:27<29:02, 25.26s/it] 60%|██████    | 104/172 [45:53<28:43, 25.34s/it] 61%|██████    | 105/172 [46:18<28:21, 25.39s/it] 62%|██████▏   | 106/172 [46:46<28:35, 25.99s/it] 62%|██████▏   | 107/172 [47:12<28:17, 26.12s/it] 63%|██████▎   | 108/172 [47:37<27:25, 25.71s/it] 63%|██████▎   | 109/172 [48:04<27:28, 26.17s/it] 64%|██████▍   | 110/172 [48:32<27:29, 26.61s/it] 65%|██████▍   | 111/172 [48:57<26:42, 26.28s/it] 65%|██████▌   | 112/172 [49:26<26:54, 26.92s/it] 66%|██████▌   | 113/172 [49:52<26:11, 26.64s/it] 66%|██████▋   | 114/172 [50:16<25:09, 26.03s/it] 67%|██████▋   | 115/172 [50:47<25:57, 27.32s/it] 67%|██████▋   | 116/172 [51:11<24:36, 26.37s/it] 68%|██████▊   | 117/172 [51:37<24:12, 26.40s/it] 69%|██████▊   | 118/172 [52:06<24:22, 27.07s/it] 69%|██████▉   | 119/172 [52:34<24:05, 27.28s/it] 70%|██████▉   | 120/172 [53:02<23:47, 27.45s/it] 70%|███████   | 121/172 [53:26<22:30, 26.47s/it] 71%|███████   | 122/172 [53:54<22:28, 26.98s/it] 72%|███████▏  | 123/172 [54:19<21:39, 26.52s/it] 72%|███████▏  | 124/172 [54:46<21:10, 26.47s/it] 73%|███████▎  | 125/172 [55:13<20:57, 26.76s/it] 73%|███████▎  | 126/172 [55:44<21:31, 28.07s/it] 74%|███████▍  | 127/172 [56:14<21:30, 28.69s/it] 74%|███████▍  | 128/172 [56:41<20:29, 27.94s/it] 75%|███████▌  | 129/172 [57:05<19:17, 26.93s/it] 76%|███████▌  | 130/172 [57:29<18:08, 25.91s/it] 76%|███████▌  | 131/172 [57:52<17:13, 25.21s/it] 77%|███████▋  | 132/172 [58:18<16:50, 25.26s/it] 77%|███████▋  | 133/172 [58:42<16:18, 25.10s/it] 78%|███████▊  | 134/172 [59:09<16:13, 25.61s/it] 78%|███████▊  | 135/172 [59:36<15:55, 25.83s/it] 79%|███████▉  | 136/172 [59:59<15:09, 25.26s/it] 80%|███████▉  | 137/172 [1:00:24<14:41, 25.18s/it] 80%|████████  | 138/172 [1:00:47<13:47, 24.33s/it] 81%|████████  | 139/172 [1:01:11<13:22, 24.33s/it] 81%|████████▏ | 140/172 [1:01:36<13:06, 24.58s/it] 82%|████████▏ | 141/172 [1:02:02<12:49, 24.81s/it] 83%|████████▎ | 142/172 [1:02:28<12:38, 25.27s/it] 83%|████████▎ | 143/172 [1:02:52<12:02, 24.93s/it] 84%|████████▎ | 144/172 [1:03:14<11:12, 24.01s/it] 84%|████████▍ | 145/172 [1:03:38<10:50, 24.08s/it] 85%|████████▍ | 146/172 [1:04:03<10:35, 24.43s/it] 85%|████████▌ | 147/172 [1:04:34<10:53, 26.16s/it] 86%|████████▌ | 148/172 [1:05:00<10:31, 26.31s/it] 87%|████████▋ | 149/172 [1:05:26<09:58, 26.03s/it] 87%|████████▋ | 150/172 [1:05:49<09:15, 25.25s/it] 88%|████████▊ | 151/172 [1:06:13<08:42, 24.90s/it] 88%|████████▊ | 152/172 [1:06:39<08:24, 25.20s/it] 89%|████████▉ | 153/172 [1:07:06<08:08, 25.68s/it] 90%|████████▉ | 154/172 [1:07:32<07:43, 25.72s/it] 90%|█████████ | 155/172 [1:07:57<07:17, 25.71s/it] 91%|█████████ | 156/172 [1:08:25<07:00, 26.28s/it] 91%|█████████▏| 157/172 [1:08:50<06:26, 25.79s/it] 92%|█████████▏| 158/172 [1:09:15<06:00, 25.73s/it] 92%|█████████▏| 159/172 [1:09:41<05:32, 25.60s/it] 93%|█████████▎| 160/172 [1:10:07<05:09, 25.76s/it] 94%|█████████▎| 161/172 [1:10:36<04:53, 26.71s/it] 94%|█████████▍| 162/172 [1:11:02<04:26, 26.62s/it] 95%|█████████▍| 163/172 [1:11:32<04:08, 27.60s/it] 95%|█████████▌| 164/172 [1:12:00<03:42, 27.84s/it] 96%|█████████▌| 165/172 [1:12:26<03:09, 27.10s/it] 97%|█████████▋| 166/172 [1:12:50<02:37, 26.27s/it] 97%|█████████▋| 167/172 [1:13:16<02:10, 26.14s/it] 98%|█████████▊| 168/172 [1:13:41<01:43, 25.92s/it] 98%|█████████▊| 169/172 [1:14:07<01:17, 25.99s/it] 99%|█████████▉| 170/172 [1:14:35<00:52, 26.34s/it] 99%|█████████▉| 171/172 [1:14:59<00:25, 25.89s/it]100%|██████████| 172/172 [1:15:04<00:00, 19.47s/it]100%|██████████| 172/172 [1:15:04<00:00, 26.19s/it]
Total: 10955
07/15/2024 23:34:19 - INFO - __main__ -     bleu-4 = 17.99 
07/15/2024 23:34:19 - INFO - __main__ -     ********************
07/15/2024 23:34:19 - INFO - __main__ -   Average inference time: 26.152096076067103
