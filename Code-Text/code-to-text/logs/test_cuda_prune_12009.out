07/12/2024 12:55:11 - INFO - __main__ -   Namespace(model_type='roberta', model_name_or_path='microsoft/codebert-base', output_dir='model/java', load_model_path='model/java/checkpoint-best-bleu/pytorch_model.bin', train_filename=None, dev_filename=None, test_filename='../dataset/java/test.jsonl', config_name='', tokenizer_name='', max_source_length=256, max_target_length=128, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, quantize=False, prune=True, train_batch_size=8, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=3, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=0, local_rank=-1, seed=42, job_id='12009', file_len=300)
07/12/2024 12:55:11 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False
07/12/2024 12:55:16 - INFO - __main__ -   reload model from model/java/checkpoint-best-bleu/pytorch_model.bin
07/12/2024 12:55:22 - INFO - __main__ -   Apply model pruning
07/12/2024 12:55:27 - INFO - __main__ -   Size (MB): 948.612026
07/12/2024 12:55:27 - INFO - __main__ -   Test file: ../dataset/java/test.jsonl
  0%|          | 0/172 [00:00<?, ?it/s]/NFSHOME/gdaloisio/code/CodeXGLUE/Code-Text/code-to-text/code/model.py:114: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  self.scores = self.tt.FloatTensor(size).zero_()
  1%|          | 1/172 [01:36<4:35:33, 96.68s/it]  1%|          | 2/172 [02:20<3:06:24, 65.79s/it]  2%|▏         | 3/172 [03:25<3:03:46, 65.25s/it]  2%|▏         | 4/172 [04:08<2:38:34, 56.63s/it]  3%|▎         | 5/172 [05:23<2:55:51, 63.18s/it]  3%|▎         | 6/172 [07:20<3:45:33, 81.52s/it]  4%|▍         | 7/172 [09:09<4:08:18, 90.29s/it]  5%|▍         | 8/172 [10:20<3:50:06, 84.19s/it]  5%|▌         | 9/172 [11:14<3:23:12, 74.80s/it]  6%|▌         | 10/172 [12:15<3:10:31, 70.56s/it]  6%|▋         | 11/172 [13:34<3:16:01, 73.05s/it]  7%|▋         | 12/172 [14:36<3:05:59, 69.75s/it]  8%|▊         | 13/172 [16:02<3:18:13, 74.80s/it]  8%|▊         | 14/172 [17:34<3:30:20, 79.88s/it]  9%|▊         | 15/172 [18:19<3:01:55, 69.53s/it]  9%|▉         | 16/172 [19:29<3:00:57, 69.60s/it] 10%|▉         | 17/172 [20:12<2:38:52, 61.50s/it] 10%|█         | 18/172 [21:36<2:55:24, 68.34s/it] 11%|█         | 19/172 [22:58<3:04:38, 72.41s/it] 12%|█▏        | 20/172 [24:02<2:56:43, 69.76s/it] 12%|█▏        | 21/172 [24:53<2:41:29, 64.17s/it] 13%|█▎        | 22/172 [25:32<2:21:48, 56.72s/it] 13%|█▎        | 23/172 [26:36<2:26:12, 58.88s/it] 14%|█▍        | 24/172 [27:26<2:18:16, 56.06s/it] 15%|█▍        | 25/172 [28:27<2:21:04, 57.58s/it] 15%|█▌        | 26/172 [29:54<2:42:01, 66.58s/it] 16%|█▌        | 27/172 [30:45<2:29:30, 61.87s/it] 16%|█▋        | 28/172 [31:38<2:21:42, 59.04s/it] 17%|█▋        | 29/172 [32:30<2:16:16, 57.18s/it] 17%|█▋        | 30/172 [33:34<2:19:38, 59.00s/it] 18%|█▊        | 31/172 [34:15<2:06:29, 53.83s/it] 19%|█▊        | 32/172 [35:07<2:03:54, 53.10s/it] 19%|█▉        | 33/172 [36:22<2:18:22, 59.73s/it] 20%|█▉        | 34/172 [37:04<2:05:04, 54.38s/it] 20%|██        | 35/172 [37:56<2:02:16, 53.55s/it] 21%|██        | 36/172 [38:38<1:53:54, 50.26s/it] 22%|██▏       | 37/172 [39:23<1:49:15, 48.56s/it] 22%|██▏       | 38/172 [40:08<1:45:57, 47.44s/it] 23%|██▎       | 39/172 [40:51<1:42:16, 46.14s/it] 23%|██▎       | 40/172 [41:52<1:51:25, 50.65s/it] 24%|██▍       | 41/172 [43:03<2:04:12, 56.89s/it] 24%|██▍       | 42/172 [44:00<2:02:53, 56.72s/it] 25%|██▌       | 43/172 [44:55<2:01:06, 56.33s/it] 26%|██▌       | 44/172 [45:57<2:03:55, 58.09s/it] 26%|██▌       | 45/172 [47:25<2:21:48, 67.00s/it] 27%|██▋       | 46/172 [48:51<2:32:44, 72.73s/it] 27%|██▋       | 47/172 [49:29<2:09:34, 62.20s/it] 28%|██▊       | 48/172 [50:21<2:02:34, 59.31s/it] 28%|██▊       | 49/172 [50:53<1:44:45, 51.10s/it] 29%|██▉       | 50/172 [52:03<1:55:27, 56.78s/it] 30%|██▉       | 51/172 [53:05<1:57:22, 58.20s/it] 30%|███       | 52/172 [54:07<1:58:35, 59.30s/it] 31%|███       | 53/172 [55:13<2:01:56, 61.48s/it] 31%|███▏      | 54/172 [57:02<2:28:33, 75.54s/it] 32%|███▏      | 55/172 [57:50<2:11:29, 67.43s/it] 33%|███▎      | 56/172 [58:48<2:04:55, 64.61s/it] 33%|███▎      | 57/172 [59:53<2:04:02, 64.71s/it] 34%|███▎      | 58/172 [1:00:55<2:01:13, 63.80s/it] 34%|███▍      | 59/172 [1:02:00<2:00:59, 64.24s/it] 35%|███▍      | 60/172 [1:02:50<1:52:08, 60.08s/it] 35%|███▌      | 61/172 [1:04:02<1:57:46, 63.67s/it] 36%|███▌      | 62/172 [1:05:39<2:14:57, 73.61s/it] 37%|███▋      | 63/172 [1:06:48<2:11:17, 72.27s/it] 37%|███▋      | 64/172 [1:07:52<2:05:15, 69.59s/it] 38%|███▊      | 65/172 [1:08:50<1:58:04, 66.21s/it] 38%|███▊      | 66/172 [1:09:41<1:48:43, 61.54s/it] 39%|███▉      | 67/172 [1:10:29<1:41:02, 57.74s/it] 40%|███▉      | 68/172 [1:11:41<1:47:25, 61.97s/it] 40%|████      | 69/172 [1:12:24<1:36:17, 56.09s/it] 41%|████      | 70/172 [1:13:06<1:28:28, 52.04s/it] 41%|████▏     | 71/172 [1:13:48<1:22:35, 49.07s/it] 42%|████▏     | 72/172 [1:14:23<1:14:28, 44.69s/it] 42%|████▏     | 73/172 [1:15:20<1:19:44, 48.33s/it] 43%|████▎     | 74/172 [1:16:28<1:28:44, 54.33s/it] 44%|████▎     | 75/172 [1:17:07<1:20:27, 49.77s/it] 44%|████▍     | 76/172 [1:18:01<1:21:26, 50.90s/it] 45%|████▍     | 77/172 [1:18:51<1:20:14, 50.68s/it] 45%|████▌     | 78/172 [1:19:41<1:18:59, 50.42s/it] 46%|████▌     | 79/172 [1:20:15<1:10:31, 45.50s/it] 47%|████▋     | 80/172 [1:21:09<1:13:42, 48.07s/it] 47%|████▋     | 81/172 [1:21:55<1:11:52, 47.39s/it] 48%|████▊     | 82/172 [1:22:28<1:04:56, 43.30s/it] 48%|████▊     | 83/172 [1:23:08<1:02:46, 42.32s/it] 49%|████▉     | 84/172 [1:23:47<1:00:35, 41.31s/it] 49%|████▉     | 85/172 [1:24:37<1:03:31, 43.81s/it] 50%|█████     | 86/172 [1:25:15<1:00:13, 42.01s/it] 51%|█████     | 87/172 [1:25:50<56:37, 39.97s/it]   51%|█████     | 88/172 [1:26:44<1:01:56, 44.24s/it] 52%|█████▏    | 89/172 [1:27:20<57:52, 41.84s/it]   52%|█████▏    | 90/172 [1:28:00<56:17, 41.19s/it] 53%|█████▎    | 91/172 [1:29:13<1:08:37, 50.83s/it] 53%|█████▎    | 92/172 [1:30:10<1:10:09, 52.61s/it] 54%|█████▍    | 93/172 [1:30:59<1:07:50, 51.52s/it] 55%|█████▍    | 94/172 [1:31:30<58:44, 45.19s/it]   55%|█████▌    | 95/172 [1:32:02<53:06, 41.38s/it] 56%|█████▌    | 96/172 [1:32:29<46:59, 37.10s/it] 56%|█████▋    | 97/172 [1:33:10<47:45, 38.21s/it] 57%|█████▋    | 98/172 [1:34:03<52:35, 42.64s/it] 58%|█████▊    | 99/172 [1:35:02<57:51, 47.55s/it] 58%|█████▊    | 100/172 [1:35:40<53:41, 44.75s/it] 59%|█████▊    | 101/172 [1:36:27<53:30, 45.22s/it] 59%|█████▉    | 102/172 [1:37:17<54:30, 46.72s/it] 60%|█████▉    | 103/172 [1:38:07<55:02, 47.86s/it] 60%|██████    | 104/172 [1:38:56<54:22, 47.98s/it] 61%|██████    | 105/172 [1:40:47<1:14:43, 66.92s/it] 62%|██████▏   | 106/172 [1:41:59<1:15:18, 68.46s/it] 62%|██████▏   | 107/172 [1:43:05<1:13:35, 67.92s/it] 63%|██████▎   | 108/172 [1:43:49<1:04:42, 60.66s/it] 63%|██████▎   | 109/172 [1:44:54<1:05:10, 62.07s/it] 64%|██████▍   | 110/172 [1:45:36<57:47, 55.92s/it]   65%|██████▍   | 111/172 [1:46:46<1:01:10, 60.17s/it] 65%|██████▌   | 112/172 [1:47:36<57:01, 57.02s/it]   66%|██████▌   | 113/172 [1:48:39<57:57, 58.93s/it] 66%|██████▋   | 114/172 [1:49:46<59:07, 61.17s/it] 67%|██████▋   | 115/172 [1:50:50<59:11, 62.30s/it] 67%|██████▋   | 116/172 [1:51:30<51:40, 55.37s/it] 68%|██████▊   | 117/172 [1:52:15<48:01, 52.39s/it] 69%|██████▊   | 118/172 [1:53:40<56:02, 62.27s/it] 69%|██████▉   | 119/172 [1:54:45<55:36, 62.95s/it] 70%|██████▉   | 120/172 [1:55:29<49:31, 57.14s/it] 70%|███████   | 121/172 [1:56:25<48:17, 56.81s/it] 71%|███████   | 122/172 [1:57:34<50:28, 60.58s/it] 72%|███████▏  | 123/172 [1:58:41<51:07, 62.60s/it] 72%|███████▏  | 124/172 [1:59:42<49:34, 61.96s/it] 73%|███████▎  | 125/172 [2:00:40<47:34, 60.74s/it] 73%|███████▎  | 126/172 [2:01:27<43:31, 56.78s/it] 74%|███████▍  | 127/172 [2:02:11<39:39, 52.87s/it] 74%|███████▍  | 128/172 [2:02:51<35:53, 48.95s/it] 75%|███████▌  | 129/172 [2:03:50<37:21, 52.12s/it] 76%|███████▌  | 130/172 [2:04:34<34:43, 49.61s/it] 76%|███████▌  | 131/172 [2:05:41<37:32, 54.94s/it] 77%|███████▋  | 132/172 [2:06:14<32:09, 48.24s/it] 77%|███████▋  | 133/172 [2:06:51<29:14, 45.00s/it] 78%|███████▊  | 134/172 [2:08:03<33:36, 53.06s/it] 78%|███████▊  | 135/172 [2:08:41<29:47, 48.31s/it] 79%|███████▉  | 136/172 [2:09:17<26:50, 44.75s/it] 80%|███████▉  | 137/172 [2:10:00<25:43, 44.11s/it] 80%|████████  | 138/172 [2:10:56<27:07, 47.88s/it] 81%|████████  | 139/172 [2:11:41<25:44, 46.80s/it] 81%|████████▏ | 140/172 [2:12:24<24:21, 45.67s/it] 82%|████████▏ | 141/172 [2:14:03<31:55, 61.78s/it] 83%|████████▎ | 142/172 [2:16:15<41:27, 82.93s/it] 83%|████████▎ | 143/172 [2:17:04<35:07, 72.68s/it] 84%|████████▎ | 144/172 [2:17:46<29:39, 63.56s/it] 84%|████████▍ | 145/172 [2:18:38<26:56, 59.87s/it] 85%|████████▍ | 146/172 [2:19:44<26:50, 61.94s/it] 85%|████████▌ | 147/172 [2:20:44<25:34, 61.40s/it] 86%|████████▌ | 148/172 [2:22:01<26:22, 65.95s/it] 87%|████████▋ | 149/172 [2:23:08<25:25, 66.31s/it] 87%|████████▋ | 150/172 [2:23:41<20:36, 56.21s/it] 88%|████████▊ | 151/172 [2:25:02<22:16, 63.63s/it] 88%|████████▊ | 152/172 [2:25:48<19:26, 58.32s/it] 89%|████████▉ | 153/172 [2:26:34<17:16, 54.57s/it] 90%|████████▉ | 154/172 [2:26:52<13:07, 43.72s/it] 90%|█████████ | 155/172 [2:27:22<11:12, 39.54s/it] 91%|█████████ | 156/172 [2:28:43<13:51, 51.97s/it] 91%|█████████▏| 157/172 [2:30:06<15:18, 61.27s/it] 92%|█████████▏| 158/172 [2:31:05<14:09, 60.70s/it] 92%|█████████▏| 159/172 [2:31:55<12:26, 57.46s/it] 93%|█████████▎| 160/172 [2:32:53<11:30, 57.57s/it] 94%|█████████▎| 161/172 [2:33:59<11:02, 60.19s/it] 94%|█████████▍| 162/172 [2:35:31<11:36, 69.61s/it] 95%|█████████▍| 163/172 [2:36:52<10:57, 73.06s/it] 95%|█████████▌| 164/172 [2:38:35<10:56, 82.07s/it] 96%|█████████▌| 165/172 [2:39:14<08:05, 69.31s/it] 97%|█████████▋| 166/172 [2:40:01<06:14, 62.49s/it] 97%|█████████▋| 167/172 [2:41:27<05:48, 69.64s/it] 98%|█████████▊| 168/172 [2:42:18<04:16, 64.07s/it] 98%|█████████▊| 169/172 [2:43:27<03:15, 65.31s/it] 99%|█████████▉| 170/172 [2:44:41<02:15, 67.97s/it] 99%|█████████▉| 171/172 [2:45:30<01:02, 62.39s/it]100%|██████████| 172/172 [2:45:38<00:00, 46.19s/it]100%|██████████| 172/172 [2:45:38<00:00, 57.78s/it]
Total: 10955
07/12/2024 15:41:21 - INFO - __main__ -     bleu-4 = 6.32 
07/12/2024 15:41:21 - INFO - __main__ -     ********************
07/12/2024 15:41:21 - INFO - __main__ -   Average inference time: 57.75699576388958
