No CUDA runtime is found, using CUDA_HOME='/usr/local/cuda'
09/08/2024 17:00:56 - INFO - __main__ -   Namespace(model_type='roberta', model_name_or_path='huggingface/CodeBERTa-small-v1', output_dir='model_codeberta_small/java', load_model_path='model_codeberta_small/java/checkpoint-best-bleu/pytorch_model.bin', train_filename=None, dev_filename=None, test_filename='../dataset/java/test.jsonl', config_name='', tokenizer_name='', max_source_length=256, max_target_length=128, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=True, quantize=False, quantize4=False, quantizef8=False, prune=False, prune4=False, prune6=False, do_retrain=False, train_batch_size=8, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=3, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=0, local_rank=-1, seed=42, job_id='155444', file_len=300)
09/08/2024 17:00:56 - WARNING - __main__ -   Process rank: -1, device: cpu, n_gpu: 2, distributed training: False
09/08/2024 17:01:03 - INFO - __main__ -   reload model from model_codeberta_small/java/checkpoint-best-bleu/pytorch_model.bin
09/08/2024 17:01:10 - INFO - __main__ -   Size (MB): 542.09314
09/08/2024 17:01:10 - INFO - __main__ -   Test file: ../dataset/java/test.jsonl
  0%|          | 0/172 [00:00<?, ?it/s]  1%|          | 1/172 [02:22<6:45:15, 142.19s/it]  1%|          | 2/172 [05:12<7:30:18, 158.93s/it]  2%|▏         | 3/172 [07:58<7:36:25, 162.04s/it]  2%|▏         | 4/172 [10:32<7:24:55, 158.90s/it]  3%|▎         | 5/172 [13:41<7:52:47, 169.87s/it]  3%|▎         | 6/172 [15:51<7:12:14, 156.23s/it]  4%|▍         | 7/172 [17:45<6:31:38, 142.41s/it]  5%|▍         | 8/172 [19:53<6:16:34, 137.77s/it]  5%|▌         | 9/172 [22:11<6:14:48, 137.97s/it]  6%|▌         | 10/172 [23:45<5:35:25, 124.23s/it]  6%|▋         | 11/172 [25:22<5:10:57, 115.88s/it]  7%|▋         | 12/172 [27:26<5:15:25, 118.29s/it]  8%|▊         | 13/172 [29:35<5:22:36, 121.74s/it]  8%|▊         | 14/172 [31:43<5:25:32, 123.63s/it]  9%|▊         | 15/172 [34:10<5:41:43, 130.59s/it]  9%|▉         | 16/172 [35:32<5:01:08, 115.82s/it] 10%|▉         | 17/172 [37:18<4:51:43, 112.92s/it] 10%|█         | 18/172 [39:08<4:47:27, 112.00s/it] 11%|█         | 19/172 [41:26<5:05:44, 119.90s/it] 12%|█▏        | 20/172 [43:46<5:19:18, 126.04s/it] 12%|█▏        | 21/172 [45:15<4:49:01, 114.84s/it] 13%|█▎        | 22/172 [46:51<4:33:15, 109.30s/it] 13%|█▎        | 23/172 [48:54<4:41:34, 113.38s/it] 14%|█▍        | 24/172 [50:53<4:43:47, 115.05s/it] 15%|█▍        | 25/172 [52:12<4:15:12, 104.17s/it] 15%|█▌        | 26/172 [54:06<4:20:43, 107.14s/it] 16%|█▌        | 27/172 [56:02<4:25:00, 109.66s/it] 16%|█▋        | 28/172 [57:17<3:58:16, 99.28s/it]  17%|█▋        | 29/172 [58:52<3:53:40, 98.05s/it] 17%|█▋        | 30/172 [1:00:19<3:44:02, 94.67s/it] 18%|█▊        | 31/172 [1:02:13<3:56:14, 100.53s/it] 19%|█▊        | 32/172 [1:04:07<4:03:57, 104.56s/it] 19%|█▉        | 33/172 [1:05:36<3:51:26, 99.90s/it]  20%|█▉        | 34/172 [1:07:15<3:49:33, 99.81s/it] 20%|██        | 35/172 [1:09:04<3:54:09, 102.55s/it] 21%|██        | 36/172 [1:10:20<3:34:20, 94.57s/it]  22%|██▏       | 37/172 [1:12:16<3:46:48, 100.81s/it] 22%|██▏       | 38/172 [1:14:17<3:59:12, 107.10s/it] 23%|██▎       | 39/172 [1:16:02<3:55:52, 106.41s/it] 23%|██▎       | 40/172 [1:18:06<4:05:21, 111.53s/it] 24%|██▍       | 41/172 [1:20:34<4:27:45, 122.63s/it] 24%|██▍       | 42/172 [1:24:02<5:20:51, 148.09s/it] 25%|██▌       | 43/172 [1:26:46<5:28:46, 152.92s/it] 26%|██▌       | 44/172 [1:29:00<5:14:03, 147.21s/it] 26%|██▌       | 45/172 [1:31:21<5:07:26, 145.25s/it] 27%|██▋       | 46/172 [1:32:50<4:29:45, 128.45s/it] 27%|██▋       | 47/172 [1:35:14<4:37:41, 133.29s/it] 28%|██▊       | 48/172 [1:37:27<4:35:14, 133.18s/it] 28%|██▊       | 49/172 [1:39:05<4:11:00, 122.45s/it] 29%|██▉       | 50/172 [1:41:02<4:05:34, 120.78s/it] 30%|██▉       | 51/172 [1:42:56<3:59:37, 118.82s/it] 30%|███       | 52/172 [1:45:01<4:01:34, 120.78s/it] 31%|███       | 53/172 [1:47:35<4:18:59, 130.58s/it] 31%|███▏      | 54/172 [1:50:05<4:28:28, 136.51s/it] 32%|███▏      | 55/172 [1:52:16<4:22:42, 134.72s/it] 33%|███▎      | 56/172 [1:54:09<4:08:06, 128.33s/it] 33%|███▎      | 57/172 [1:56:28<4:12:23, 131.68s/it] 34%|███▎      | 58/172 [1:59:13<4:28:41, 141.42s/it] 34%|███▍      | 59/172 [2:01:40<4:29:27, 143.08s/it] 35%|███▍      | 60/172 [2:04:25<4:39:30, 149.74s/it] 35%|███▌      | 61/172 [2:07:19<4:50:27, 157.01s/it] 36%|███▌      | 62/172 [2:10:30<5:06:24, 167.13s/it] 37%|███▋      | 63/172 [2:14:15<5:35:31, 184.70s/it] 37%|███▋      | 64/172 [2:17:53<5:50:04, 194.48s/it] 38%|███▊      | 65/172 [2:21:05<5:45:34, 193.78s/it] 38%|███▊      | 66/172 [2:24:08<5:36:55, 190.71s/it] 39%|███▉      | 67/172 [2:27:28<5:38:36, 193.49s/it] 40%|███▉      | 68/172 [2:30:32<5:30:31, 190.69s/it] 40%|████      | 69/172 [2:33:55<5:33:16, 194.14s/it] 41%|████      | 70/172 [2:37:14<5:32:33, 195.62s/it] 41%|████▏     | 71/172 [2:40:33<5:31:18, 196.82s/it] 42%|████▏     | 72/172 [2:43:32<5:19:04, 191.44s/it] 42%|████▏     | 73/172 [2:46:02<4:55:18, 178.98s/it] 43%|████▎     | 74/172 [2:48:34<4:39:19, 171.02s/it] 44%|████▎     | 75/172 [2:51:10<4:28:54, 166.33s/it] 44%|████▍     | 76/172 [2:53:12<4:04:42, 152.94s/it] 45%|████▍     | 77/172 [2:55:25<3:53:03, 147.19s/it] 45%|████▌     | 78/172 [2:58:02<3:54:54, 149.95s/it] 46%|████▌     | 79/172 [3:00:13<3:43:47, 144.38s/it] 47%|████▋     | 80/172 [3:02:34<3:40:00, 143.48s/it] 47%|████▋     | 81/172 [3:05:21<3:48:08, 150.42s/it] 48%|████▊     | 82/172 [3:06:56<3:20:45, 133.84s/it] 48%|████▊     | 83/172 [3:08:56<3:12:19, 129.65s/it] 49%|████▉     | 84/172 [3:11:21<3:16:41, 134.11s/it] 49%|████▉     | 85/172 [3:13:49<3:20:46, 138.46s/it] 50%|█████     | 86/172 [3:15:25<2:59:56, 125.54s/it] 51%|█████     | 87/172 [3:17:28<2:57:02, 124.97s/it] 51%|█████     | 88/172 [3:19:34<2:55:09, 125.11s/it] 52%|█████▏    | 89/172 [3:21:30<2:49:34, 122.59s/it] 52%|█████▏    | 90/172 [3:23:10<2:38:12, 115.77s/it] 53%|█████▎    | 91/172 [3:25:29<2:45:35, 122.66s/it] 53%|█████▎    | 92/172 [3:27:09<2:34:36, 115.95s/it] 54%|█████▍    | 93/172 [3:28:33<2:19:54, 106.25s/it] 55%|█████▍    | 94/172 [3:29:55<2:08:49, 99.09s/it]  55%|█████▌    | 95/172 [3:31:30<2:05:36, 97.87s/it] 56%|█████▌    | 96/172 [3:32:54<1:58:43, 93.73s/it] 56%|█████▋    | 97/172 [3:34:40<2:01:43, 97.38s/it] 57%|█████▋    | 98/172 [3:36:09<1:56:45, 94.67s/it] 58%|█████▊    | 99/172 [3:37:39<1:53:29, 93.29s/it] 58%|█████▊    | 100/172 [3:39:11<1:51:30, 92.92s/it] 59%|█████▊    | 101/172 [3:40:25<1:43:25, 87.41s/it] 59%|█████▉    | 102/172 [3:41:48<1:40:18, 85.97s/it] 60%|█████▉    | 103/172 [3:43:42<1:48:25, 94.28s/it] 60%|██████    | 104/172 [3:45:24<1:49:26, 96.57s/it] 61%|██████    | 105/172 [3:46:53<1:45:31, 94.49s/it] 62%|██████▏   | 106/172 [3:48:21<1:41:50, 92.59s/it] 62%|██████▏   | 107/172 [3:49:44<1:36:58, 89.52s/it] 63%|██████▎   | 108/172 [3:51:35<1:42:30, 96.10s/it] 63%|██████▎   | 109/172 [3:53:47<1:52:10, 106.83s/it] 64%|██████▍   | 110/172 [3:55:47<1:54:26, 110.76s/it] 65%|██████▍   | 111/172 [3:57:53<1:57:18, 115.38s/it] 65%|██████▌   | 112/172 [3:59:34<1:51:08, 111.13s/it] 66%|██████▌   | 113/172 [4:00:54<1:39:52, 101.56s/it] 66%|██████▋   | 114/172 [4:02:45<1:40:56, 104.43s/it] 67%|██████▋   | 115/172 [4:04:25<1:38:04, 103.24s/it] 67%|██████▋   | 116/172 [4:06:07<1:35:55, 102.77s/it] 68%|██████▊   | 117/172 [4:24:41<6:12:18, 406.15s/it] 69%|██████▊   | 118/172 [4:59:10<13:34:29, 905.00s/it] 69%|██████▉   | 119/172 [5:27:05<16:43:30, 1136.04s/it] 70%|██████▉   | 120/172 [5:29:09<12:01:20, 832.31s/it]  70%|███████   | 121/172 [5:31:26<8:50:10, 623.74s/it]  71%|███████   | 122/172 [5:33:42<6:38:03, 477.68s/it] 72%|███████▏  | 123/172 [5:35:29<4:59:12, 366.38s/it] 72%|███████▏  | 124/172 [5:37:07<3:48:46, 285.97s/it] 73%|███████▎  | 125/172 [5:38:41<2:58:47, 228.24s/it] 73%|███████▎  | 126/172 [5:40:04<2:21:31, 184.59s/it] 74%|███████▍  | 127/172 [5:41:33<1:57:04, 156.10s/it] 74%|███████▍  | 128/172 [5:44:29<1:58:48, 162.01s/it] 75%|███████▌  | 129/172 [5:48:38<2:14:43, 187.98s/it] 76%|███████▌  | 130/172 [5:52:24<2:19:34, 199.39s/it] 76%|███████▌  | 131/172 [5:54:17<1:58:30, 173.44s/it] 77%|███████▋  | 132/172 [5:56:08<1:43:15, 154.88s/it] 77%|███████▋  | 133/172 [5:57:40<1:28:26, 136.07s/it] 78%|███████▊  | 134/172 [5:59:46<1:24:12, 132.97s/it] 78%|███████▊  | 135/172 [6:01:51<1:20:29, 130.53s/it] 79%|███████▉  | 136/172 [6:03:37<1:13:49, 123.03s/it] 80%|███████▉  | 137/172 [6:05:34<1:10:51, 121.47s/it] 80%|████████  | 138/172 [6:07:43<1:10:03, 123.64s/it] 81%|████████  | 139/172 [6:08:52<59:00, 107.27s/it]   81%|████████▏ | 140/172 [6:11:04<1:01:07, 114.61s/it] 82%|████████▏ | 141/172 [6:12:27<54:19, 105.13s/it]   83%|████████▎ | 142/172 [6:14:12<52:31, 105.04s/it] 83%|████████▎ | 143/172 [6:15:55<50:34, 104.65s/it] 84%|████████▎ | 144/172 [6:17:12<44:56, 96.31s/it]  84%|████████▍ | 145/172 [6:18:41<42:20, 94.10s/it] 85%|████████▍ | 146/172 [6:20:22<41:40, 96.17s/it] 85%|████████▌ | 147/172 [6:21:34<36:58, 88.73s/it] 86%|████████▌ | 148/172 [6:23:18<37:20, 93.34s/it] 87%|████████▋ | 149/172 [6:25:11<38:01, 99.20s/it] 87%|████████▋ | 150/172 [6:26:27<33:49, 92.26s/it] 88%|████████▊ | 151/172 [6:28:09<33:21, 95.29s/it] 88%|████████▊ | 152/172 [6:29:37<31:03, 93.16s/it] 89%|████████▉ | 153/172 [6:31:15<29:54, 94.44s/it] 90%|████████▉ | 154/172 [6:32:55<28:50, 96.12s/it] 90%|█████████ | 155/172 [6:34:21<26:22, 93.09s/it] 91%|█████████ | 156/172 [6:36:15<26:32, 99.53s/it] 91%|█████████▏| 157/172 [6:38:02<25:23, 101.59s/it] 92%|█████████▏| 158/172 [6:39:10<21:23, 91.68s/it]  92%|█████████▏| 159/172 [6:41:02<21:10, 97.70s/it] 93%|█████████▎| 160/172 [6:42:29<18:55, 94.59s/it] 94%|█████████▎| 161/172 [6:44:23<18:22, 100.24s/it] 94%|█████████▍| 162/172 [6:46:23<17:42, 106.27s/it] 95%|█████████▍| 163/172 [6:48:05<15:45, 105.09s/it] 95%|█████████▌| 164/172 [6:49:56<14:14, 106.80s/it] 96%|█████████▌| 165/172 [6:51:56<12:55, 110.79s/it] 97%|█████████▋| 166/172 [6:54:01<11:29, 114.86s/it] 97%|█████████▋| 167/172 [6:55:30<08:55, 107.18s/it] 98%|█████████▊| 168/172 [6:57:08<06:58, 104.59s/it] 98%|█████████▊| 169/172 [6:59:19<05:37, 112.46s/it] 99%|█████████▉| 170/172 [7:01:26<03:53, 116.74s/it] 99%|█████████▉| 171/172 [7:03:04<01:51, 111.24s/it]100%|██████████| 172/172 [7:03:37<00:00, 87.77s/it] 100%|██████████| 172/172 [7:03:37<00:00, 147.78s/it]
Traceback (most recent call last):
  File "/NFSHOME/gdaloisio/code/CodeXGLUE/Code-Text/code-to-text/code/run.py", line 877, in <module>
    main()
  File "/NFSHOME/gdaloisio/code/CodeXGLUE/Code-Text/code-to-text/code/run.py", line 862, in main
    (goldMap, predictionMap) = bleu.computeMaps(predictions, os.path.join(args.output_dir, "test_{}.gold".format(idx))) 
  File "/NFSHOME/gdaloisio/code/CodeXGLUE/Code-Text/code-to-text/code/bleu.py", line 159, in computeMaps
    gf = open(goldfile, 'r')
FileNotFoundError: [Errno 2] No such file or directory: 'model_codeberta_small/java/test_0.gold'
srun: error: compute-0-3: task 0: Exited with exit code 1
