05/15/2025 17:13:31 - INFO - __main__ -   Namespace(model_type='t5', model_name_or_path='Salesforce/codet5-base', output_dir='model_t5/java', load_model_path='model_t5/java/checkpoint-best-bleu/pytorch_model.bin', train_filename=None, dev_filename=None, test_filename='../dataset/java/test.jsonl', config_name='', tokenizer_name='', max_source_length=256, max_target_length=128, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=True, quantize=False, quantize4=False, quantizef8=False, prune=False, prune4=True, prune6=False, do_retrain=False, train_batch_size=8, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=3, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=0, local_rank=-1, seed=42, job_id='488445', file_len=300)
05/15/2025 17:13:31 - WARNING - __main__ -   Process rank: -1, device: cpu, n_gpu: 0, distributed training: False
05/15/2025 17:13:33 - INFO - __main__ -   reload model from model_t5/java/checkpoint-best-bleu/pytorch_model.bin
05/15/2025 17:13:34 - INFO - __main__ -   Apply model pruning 0.4
05/15/2025 17:13:56 - INFO - __main__ -   Size (MB): 891.644607
05/15/2025 17:13:56 - INFO - __main__ -   Test file: ../dataset/java/test.jsonl
================================================================================
Layer (type:depth-idx)                                  Param #
================================================================================
T5ForConditionalGeneration                              --
├─Embedding: 1-1                                        24,652,800
├─T5Stack: 1-2                                          24,652,800
│    └─Embedding: 2-1                                   (recursive)
│    └─ModuleList: 2-2                                  --
│    │    └─T5Block: 3-1                                7,079,808
│    │    └─T5Block: 3-2                                7,079,424
│    │    └─T5Block: 3-3                                7,079,424
│    │    └─T5Block: 3-4                                7,079,424
│    │    └─T5Block: 3-5                                7,079,424
│    │    └─T5Block: 3-6                                7,079,424
│    │    └─T5Block: 3-7                                7,079,424
│    │    └─T5Block: 3-8                                7,079,424
│    │    └─T5Block: 3-9                                7,079,424
│    │    └─T5Block: 3-10                               7,079,424
│    │    └─T5Block: 3-11                               7,079,424
│    │    └─T5Block: 3-12                               7,079,424
│    └─T5LayerNorm: 2-3                                 768
│    └─Dropout: 2-4                                     --
├─T5Stack: 1-3                                          24,652,800
│    └─Embedding: 2-5                                   (recursive)
│    └─ModuleList: 2-6                                  --
│    │    └─T5Block: 3-13                               9,439,872
│    │    └─T5Block: 3-14                               9,439,488
│    │    └─T5Block: 3-15                               9,439,488
│    │    └─T5Block: 3-16                               9,439,488
│    │    └─T5Block: 3-17                               9,439,488
│    │    └─T5Block: 3-18                               9,439,488
│    │    └─T5Block: 3-19                               9,439,488
│    │    └─T5Block: 3-20                               9,439,488
│    │    └─T5Block: 3-21                               9,439,488
│    │    └─T5Block: 3-22                               9,439,488
│    │    └─T5Block: 3-23                               9,439,488
│    │    └─T5Block: 3-24                               9,439,488
│    └─T5LayerNorm: 2-7                                 768
│    └─Dropout: 2-8                                     --
├─Linear: 1-4                                           24,652,800
================================================================================
Total params: 296,840,448
Trainable params: 296,840,448
Non-trainable params: 0
================================================================================
  0%|          | 0/172 [00:00<?, ?it/s]/NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/transformers/generation/utils.py:1249: UserWarning: Using the model-agnostic default `max_length` (=20) to control the generation length. We recommend setting `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
  1%|          | 1/172 [00:15<45:08, 15.84s/it]  1%|          | 2/172 [00:28<39:44, 14.03s/it]  2%|▏         | 3/172 [00:39<35:53, 12.74s/it]  2%|▏         | 4/172 [00:54<37:50, 13.51s/it]  3%|▎         | 5/172 [01:07<36:44, 13.20s/it]  3%|▎         | 6/172 [01:20<37:05, 13.41s/it]  4%|▍         | 7/172 [01:31<34:03, 12.38s/it]  5%|▍         | 8/172 [01:43<33:53, 12.40s/it]  5%|▌         | 9/172 [01:55<33:34, 12.36s/it]  6%|▌         | 10/172 [02:07<32:22, 11.99s/it]  6%|▋         | 11/172 [02:21<34:03, 12.69s/it]  7%|▋         | 12/172 [02:35<34:38, 12.99s/it]  8%|▊         | 13/172 [02:50<36:25, 13.75s/it]  8%|▊         | 14/172 [03:04<36:25, 13.83s/it]  9%|▊         | 15/172 [03:15<33:52, 12.95s/it]  9%|▉         | 16/172 [03:29<34:08, 13.13s/it] 10%|▉         | 17/172 [03:41<33:17, 12.89s/it] 10%|█         | 18/172 [03:56<34:32, 13.46s/it] 11%|█         | 19/172 [04:08<33:41, 13.21s/it] 12%|█▏        | 20/172 [04:22<33:33, 13.25s/it] 12%|█▏        | 21/172 [04:34<32:27, 12.90s/it] 13%|█▎        | 22/172 [04:45<30:42, 12.28s/it] 13%|█▎        | 23/172 [04:57<30:55, 12.45s/it] 14%|█▍        | 24/172 [05:10<30:38, 12.42s/it] 15%|█▍        | 25/172 [05:23<31:23, 12.82s/it] 15%|█▌        | 26/172 [05:38<32:15, 13.26s/it] 16%|█▌        | 27/172 [05:51<32:15, 13.35s/it] 16%|█▋        | 28/172 [06:05<31:54, 13.30s/it] 17%|█▋        | 29/172 [06:20<33:12, 13.93s/it] 17%|█▋        | 30/172 [06:31<30:57, 13.08s/it] 18%|█▊        | 31/172 [06:42<29:01, 12.35s/it] 19%|█▊        | 32/172 [06:55<29:31, 12.65s/it] 19%|█▉        | 33/172 [07:08<29:28, 12.72s/it] 20%|█▉        | 34/172 [07:21<29:48, 12.96s/it] 20%|██        | 35/172 [07:35<30:01, 13.15s/it] 21%|██        | 36/172 [07:46<28:24, 12.54s/it] 22%|██▏       | 37/172 [07:58<27:50, 12.37s/it] 22%|██▏       | 38/172 [08:09<26:24, 11.83s/it] 23%|██▎       | 39/172 [08:21<26:19, 11.88s/it] 23%|██▎       | 40/172 [08:36<28:14, 12.84s/it] 24%|██▍       | 41/172 [08:49<28:04, 12.86s/it] 24%|██▍       | 42/172 [08:59<26:09, 12.08s/it] 25%|██▌       | 43/172 [09:12<26:25, 12.29s/it] 26%|██▌       | 44/172 [09:23<25:28, 11.94s/it] 26%|██▌       | 45/172 [09:34<25:02, 11.83s/it] 27%|██▋       | 46/172 [09:47<25:16, 12.03s/it] 27%|██▋       | 47/172 [09:58<24:41, 11.85s/it] 28%|██▊       | 48/172 [10:14<26:49, 12.98s/it] 28%|██▊       | 49/172 [10:26<26:00, 12.69s/it] 29%|██▉       | 50/172 [10:38<25:38, 12.61s/it] 30%|██▉       | 51/172 [10:52<26:08, 12.96s/it] 30%|███       | 52/172 [11:06<26:35, 13.30s/it] 31%|███       | 53/172 [11:18<25:20, 12.78s/it] 31%|███▏      | 54/172 [11:29<24:06, 12.26s/it] 32%|███▏      | 55/172 [11:45<25:59, 13.33s/it] 33%|███▎      | 56/172 [12:00<27:05, 14.02s/it] 33%|███▎      | 57/172 [12:14<26:46, 13.97s/it] 34%|███▎      | 58/172 [12:30<27:24, 14.42s/it] 34%|███▍      | 59/172 [12:44<26:58, 14.32s/it] 35%|███▍      | 60/172 [12:56<25:38, 13.73s/it] 35%|███▌      | 61/172 [13:08<24:32, 13.26s/it] 36%|███▌      | 62/172 [13:21<24:03, 13.13s/it] 37%|███▋      | 63/172 [13:35<24:14, 13.35s/it] 37%|███▋      | 64/172 [13:49<24:39, 13.70s/it] 38%|███▊      | 65/172 [14:03<24:25, 13.69s/it] 38%|███▊      | 66/172 [14:16<23:54, 13.54s/it] 39%|███▉      | 67/172 [14:29<23:28, 13.41s/it] 40%|███▉      | 68/172 [14:42<23:03, 13.30s/it] 40%|████      | 69/172 [14:55<22:37, 13.18s/it] 41%|████      | 70/172 [15:07<21:43, 12.78s/it] 41%|████▏     | 71/172 [15:21<22:04, 13.12s/it] 42%|████▏     | 72/172 [15:32<20:55, 12.56s/it] 42%|████▏     | 73/172 [15:46<21:03, 12.76s/it] 43%|████▎     | 74/172 [15:58<20:26, 12.51s/it] 44%|████▎     | 75/172 [16:10<20:07, 12.45s/it] 44%|████▍     | 76/172 [16:23<20:10, 12.61s/it] 45%|████▍     | 77/172 [16:35<19:54, 12.58s/it] 45%|████▌     | 78/172 [16:46<18:48, 12.00s/it] 46%|████▌     | 79/172 [16:57<18:06, 11.68s/it] 47%|████▋     | 80/172 [17:10<18:36, 12.14s/it] 47%|████▋     | 81/172 [17:21<17:57, 11.84s/it] 48%|████▊     | 82/172 [17:35<18:25, 12.28s/it] 48%|████▊     | 83/172 [17:46<18:02, 12.16s/it] 49%|████▉     | 84/172 [18:01<18:56, 12.91s/it] 49%|████▉     | 85/172 [18:12<17:48, 12.28s/it] 50%|█████     | 86/172 [18:25<17:50, 12.44s/it] 51%|█████     | 87/172 [18:40<18:58, 13.39s/it] 51%|█████     | 88/172 [18:52<17:51, 12.75s/it] 52%|█████▏    | 89/172 [19:04<17:22, 12.56s/it] 52%|█████▏    | 90/172 [19:15<16:36, 12.15s/it] 53%|█████▎    | 91/172 [19:30<17:46, 13.16s/it] 53%|█████▎    | 92/172 [19:43<17:19, 12.99s/it] 54%|█████▍    | 93/172 [19:56<16:54, 12.85s/it] 55%|█████▍    | 94/172 [20:08<16:25, 12.64s/it] 55%|█████▌    | 95/172 [20:19<15:36, 12.16s/it] 56%|█████▌    | 96/172 [20:34<16:38, 13.14s/it] 56%|█████▋    | 97/172 [20:50<17:21, 13.89s/it] 57%|█████▋    | 98/172 [21:03<16:53, 13.69s/it] 58%|█████▊    | 99/172 [21:17<16:40, 13.71s/it] 58%|█████▊    | 100/172 [21:29<15:48, 13.18s/it] 59%|█████▊    | 101/172 [21:39<14:40, 12.41s/it] 59%|█████▉    | 102/172 [21:54<15:17, 13.10s/it] 60%|█████▉    | 103/172 [22:07<14:52, 12.94s/it] 60%|██████    | 104/172 [22:19<14:35, 12.88s/it] 61%|██████    | 105/172 [22:35<15:18, 13.71s/it] 62%|██████▏   | 106/172 [22:47<14:33, 13.24s/it] 62%|██████▏   | 107/172 [23:01<14:33, 13.43s/it] 63%|██████▎   | 108/172 [23:12<13:33, 12.71s/it] 63%|██████▎   | 109/172 [23:26<13:41, 13.04s/it] 64%|██████▍   | 110/172 [23:37<12:54, 12.50s/it] 65%|██████▍   | 111/172 [23:49<12:37, 12.41s/it] 65%|██████▌   | 112/172 [24:01<12:18, 12.30s/it] 66%|██████▌   | 113/172 [24:16<12:42, 12.93s/it] 66%|██████▋   | 114/172 [24:30<12:54, 13.35s/it] 67%|██████▋   | 115/172 [24:43<12:29, 13.15s/it] 67%|██████▋   | 116/172 [24:54<11:46, 12.61s/it] 68%|██████▊   | 117/172 [25:06<11:29, 12.54s/it] 69%|██████▊   | 118/172 [25:19<11:19, 12.59s/it] 69%|██████▉   | 119/172 [25:32<11:09, 12.64s/it] 70%|██████▉   | 120/172 [25:45<10:58, 12.66s/it] 70%|███████   | 121/172 [25:57<10:40, 12.56s/it] 71%|███████   | 122/172 [26:12<11:01, 13.23s/it] 72%|███████▏  | 123/172 [26:25<10:49, 13.26s/it] 72%|███████▏  | 124/172 [26:37<10:11, 12.74s/it] 73%|███████▎  | 125/172 [26:49<09:58, 12.73s/it] 73%|███████▎  | 126/172 [27:05<10:23, 13.56s/it] 74%|███████▍  | 127/172 [27:20<10:34, 14.10s/it] 74%|███████▍  | 128/172 [27:34<10:14, 13.97s/it] 75%|███████▌  | 129/172 [27:49<10:18, 14.38s/it] 76%|███████▌  | 130/172 [28:02<09:43, 13.90s/it] 76%|███████▌  | 131/172 [28:14<09:06, 13.33s/it] 77%|███████▋  | 132/172 [28:25<08:26, 12.67s/it] 77%|███████▋  | 133/172 [28:38<08:16, 12.73s/it] 78%|███████▊  | 134/172 [28:49<07:42, 12.18s/it] 78%|███████▊  | 135/172 [29:02<07:42, 12.50s/it] 79%|███████▉  | 136/172 [29:17<07:53, 13.15s/it] 80%|███████▉  | 137/172 [29:30<07:43, 13.25s/it] 80%|████████  | 138/172 [29:42<07:15, 12.82s/it] 81%|████████  | 139/172 [29:55<07:00, 12.75s/it] 81%|████████▏ | 140/172 [30:10<07:13, 13.55s/it] 82%|████████▏ | 141/172 [30:22<06:44, 13.04s/it] 83%|████████▎ | 142/172 [30:37<06:49, 13.64s/it] 83%|████████▎ | 143/172 [30:51<06:35, 13.64s/it] 84%|████████▎ | 144/172 [31:04<06:22, 13.67s/it] 84%|████████▍ | 145/172 [31:15<05:45, 12.81s/it] 85%|████████▍ | 146/172 [31:25<05:12, 12.02s/it] 85%|████████▌ | 147/172 [31:38<05:02, 12.11s/it] 86%|████████▌ | 148/172 [31:50<04:49, 12.04s/it] 87%|████████▋ | 149/172 [32:05<04:58, 12.99s/it] 87%|████████▋ | 150/172 [32:16<04:34, 12.48s/it] 88%|████████▊ | 151/172 [32:31<04:34, 13.08s/it] 88%|████████▊ | 152/172 [32:44<04:26, 13.31s/it] 89%|████████▉ | 153/172 [32:57<04:07, 13.05s/it] 90%|████████▉ | 154/172 [33:08<03:43, 12.39s/it] 90%|█████████ | 155/172 [33:20<03:29, 12.30s/it] 91%|█████████ | 156/172 [33:32<03:16, 12.26s/it] 91%|█████████▏| 157/172 [33:45<03:05, 12.39s/it] 92%|█████████▏| 158/172 [33:55<02:46, 11.87s/it] 92%|█████████▏| 159/172 [34:07<02:35, 11.97s/it] 93%|█████████▎| 160/172 [34:19<02:23, 11.99s/it] 94%|█████████▎| 161/172 [34:32<02:12, 12.07s/it] 94%|█████████▍| 162/172 [34:43<01:59, 11.90s/it] 95%|█████████▍| 163/172 [34:54<01:45, 11.68s/it] 95%|█████████▌| 164/172 [35:05<01:30, 11.26s/it] 96%|█████████▌| 165/172 [35:13<01:13, 10.46s/it] 97%|█████████▋| 166/172 [35:23<01:00, 10.15s/it] 97%|█████████▋| 167/172 [35:33<00:50, 10.05s/it] 98%|█████████▊| 168/172 [35:42<00:39,  9.86s/it] 98%|█████████▊| 169/172 [35:53<00:31, 10.35s/it] 99%|█████████▉| 170/172 [36:10<00:24, 12.06s/it] 99%|█████████▉| 171/172 [36:24<00:12, 12.90s/it]100%|██████████| 172/172 [36:28<00:00, 10.07s/it]100%|██████████| 172/172 [36:28<00:00, 12.72s/it]
Total: 10955
05/15/2025 17:50:48 - INFO - __main__ -     bleu-4 = 19.42 
05/15/2025 17:50:48 - INFO - __main__ -     ********************
05/15/2025 17:50:48 - INFO - __main__ -   Average inference time: 12.328668349011
