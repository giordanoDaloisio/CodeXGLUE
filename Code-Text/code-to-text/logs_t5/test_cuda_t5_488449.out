05/16/2025 12:03:21 - INFO - __main__ -   Namespace(model_type='t5', model_name_or_path='Salesforce/codet5-base', output_dir='model_t5/java', load_model_path='model_t5/java/checkpoint-best-bleu/pytorch_model.bin', train_filename=None, dev_filename='../dataset/java/valid.jsonl', test_filename='../dataset/java/test.jsonl', config_name='', tokenizer_name='', max_source_length=256, max_target_length=128, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, quantize=False, quantize4=False, quantizef8=False, prune=False, prune4=False, prune6=False, do_retrain=False, train_batch_size=8, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=3, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=0, local_rank=-1, seed=42, job_id='488449', file_len=None)
05/16/2025 12:03:21 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False
05/16/2025 12:03:24 - INFO - __main__ -   reload model from model_t5/java/checkpoint-best-bleu/pytorch_model.bin
05/16/2025 12:03:34 - INFO - __main__ -   Size (MB): 891.648255
05/16/2025 12:03:34 - INFO - __main__ -   Test file: ../dataset/java/valid.jsonl
05/16/2025 12:03:40 - INFO - __main__ -   ********* GPU-WARM-UP ********
/NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/transformers/generation/utils.py:1249: UserWarning: Using the model-agnostic default `max_length` (=20) to control the generation length. We recommend setting `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
================================================================================
Layer (type:depth-idx)                                  Param #
================================================================================
T5ForConditionalGeneration                              --
├─Embedding: 1-1                                        24,652,800
├─T5Stack: 1-2                                          24,652,800
│    └─Embedding: 2-1                                   (recursive)
│    └─ModuleList: 2-2                                  --
│    │    └─T5Block: 3-1                                7,079,808
│    │    └─T5Block: 3-2                                7,079,424
│    │    └─T5Block: 3-3                                7,079,424
│    │    └─T5Block: 3-4                                7,079,424
│    │    └─T5Block: 3-5                                7,079,424
│    │    └─T5Block: 3-6                                7,079,424
│    │    └─T5Block: 3-7                                7,079,424
│    │    └─T5Block: 3-8                                7,079,424
│    │    └─T5Block: 3-9                                7,079,424
│    │    └─T5Block: 3-10                               7,079,424
│    │    └─T5Block: 3-11                               7,079,424
│    │    └─T5Block: 3-12                               7,079,424
│    └─T5LayerNorm: 2-3                                 768
│    └─Dropout: 2-4                                     --
├─T5Stack: 1-3                                          24,652,800
│    └─Embedding: 2-5                                   (recursive)
│    └─ModuleList: 2-6                                  --
│    │    └─T5Block: 3-13                               9,439,872
│    │    └─T5Block: 3-14                               9,439,488
│    │    └─T5Block: 3-15                               9,439,488
│    │    └─T5Block: 3-16                               9,439,488
│    │    └─T5Block: 3-17                               9,439,488
│    │    └─T5Block: 3-18                               9,439,488
│    │    └─T5Block: 3-19                               9,439,488
│    │    └─T5Block: 3-20                               9,439,488
│    │    └─T5Block: 3-21                               9,439,488
│    │    └─T5Block: 3-22                               9,439,488
│    │    └─T5Block: 3-23                               9,439,488
│    │    └─T5Block: 3-24                               9,439,488
│    └─T5LayerNorm: 2-7                                 768
│    └─Dropout: 2-8                                     --
├─Linear: 1-4                                           24,652,800
================================================================================
Total params: 296,840,448
Trainable params: 296,840,448
Non-trainable params: 0
================================================================================
  0%|          | 0/81 [00:00<?, ?it/s]  1%|          | 1/81 [00:02<03:08,  2.35s/it]  2%|▏         | 2/81 [00:04<03:07,  2.37s/it]  4%|▎         | 3/81 [00:07<03:05,  2.38s/it]  5%|▍         | 4/81 [00:09<03:03,  2.38s/it]  6%|▌         | 5/81 [00:11<03:00,  2.38s/it]  7%|▋         | 6/81 [00:14<02:57,  2.37s/it]  9%|▊         | 7/81 [00:16<02:55,  2.37s/it] 10%|▉         | 8/81 [00:18<02:53,  2.37s/it] 11%|█         | 9/81 [00:21<02:48,  2.33s/it] 12%|█▏        | 10/81 [00:23<02:43,  2.31s/it] 14%|█▎        | 11/81 [00:26<02:49,  2.42s/it] 15%|█▍        | 12/81 [00:28<02:44,  2.39s/it] 16%|█▌        | 13/81 [00:30<02:41,  2.38s/it] 17%|█▋        | 14/81 [00:33<02:36,  2.34s/it] 19%|█▊        | 15/81 [00:35<02:35,  2.35s/it] 20%|█▉        | 16/81 [00:37<02:33,  2.36s/it] 21%|██        | 17/81 [00:40<02:31,  2.37s/it] 22%|██▏       | 18/81 [00:42<02:29,  2.37s/it] 23%|██▎       | 19/81 [00:44<02:26,  2.36s/it] 25%|██▍       | 20/81 [00:47<02:24,  2.36s/it] 26%|██▌       | 21/81 [00:49<02:21,  2.36s/it] 27%|██▋       | 22/81 [00:52<02:19,  2.37s/it] 28%|██▊       | 23/81 [00:54<02:17,  2.37s/it] 30%|██▉       | 24/81 [00:56<02:15,  2.37s/it] 31%|███       | 25/81 [00:59<02:12,  2.37s/it] 32%|███▏      | 26/81 [01:01<02:10,  2.37s/it] 33%|███▎      | 27/81 [01:03<02:07,  2.37s/it] 35%|███▍      | 28/81 [01:06<02:05,  2.37s/it] 36%|███▌      | 29/81 [01:08<02:03,  2.37s/it] 37%|███▋      | 30/81 [01:11<02:00,  2.37s/it] 38%|███▊      | 31/81 [01:13<01:58,  2.37s/it] 40%|███▉      | 32/81 [01:15<01:54,  2.33s/it] 41%|████      | 33/81 [01:17<01:52,  2.34s/it] 42%|████▏     | 34/81 [01:20<01:50,  2.35s/it] 43%|████▎     | 35/81 [01:22<01:47,  2.34s/it] 44%|████▍     | 36/81 [01:25<01:45,  2.35s/it] 46%|████▌     | 37/81 [01:27<01:43,  2.36s/it] 47%|████▋     | 38/81 [01:29<01:40,  2.34s/it] 48%|████▊     | 39/81 [01:32<01:38,  2.35s/it] 49%|████▉     | 40/81 [01:34<01:36,  2.35s/it] 51%|█████     | 41/81 [01:36<01:34,  2.36s/it] 52%|█████▏    | 42/81 [01:39<01:32,  2.36s/it] 53%|█████▎    | 43/81 [01:41<01:29,  2.36s/it] 54%|█████▍    | 44/81 [01:43<01:26,  2.34s/it] 56%|█████▌    | 45/81 [01:46<01:23,  2.31s/it] 57%|█████▋    | 46/81 [01:48<01:20,  2.31s/it] 58%|█████▊    | 47/81 [01:50<01:18,  2.32s/it] 59%|█████▉    | 48/81 [01:53<01:16,  2.32s/it] 60%|██████    | 49/81 [01:55<01:14,  2.34s/it] 62%|██████▏   | 50/81 [01:57<01:12,  2.35s/it] 63%|██████▎   | 51/81 [02:00<01:10,  2.35s/it] 64%|██████▍   | 52/81 [02:02<01:08,  2.36s/it] 65%|██████▌   | 53/81 [02:04<01:06,  2.36s/it] 67%|██████▋   | 54/81 [02:07<01:02,  2.31s/it] 68%|██████▊   | 55/81 [02:09<01:00,  2.32s/it] 69%|██████▉   | 56/81 [02:11<00:58,  2.33s/it] 70%|███████   | 57/81 [02:14<00:56,  2.35s/it] 72%|███████▏  | 58/81 [02:16<00:54,  2.35s/it] 73%|███████▎  | 59/81 [02:18<00:51,  2.36s/it] 74%|███████▍  | 60/81 [02:21<00:49,  2.34s/it] 75%|███████▌  | 61/81 [02:23<00:46,  2.31s/it] 77%|███████▋  | 62/81 [02:25<00:43,  2.31s/it] 78%|███████▊  | 63/81 [02:28<00:41,  2.33s/it] 79%|███████▉  | 64/81 [02:30<00:39,  2.32s/it] 80%|████████  | 65/81 [02:32<00:37,  2.32s/it] 81%|████████▏ | 66/81 [02:34<00:34,  2.27s/it] 83%|████████▎ | 67/81 [02:37<00:32,  2.30s/it] 84%|████████▍ | 68/81 [02:39<00:30,  2.32s/it] 85%|████████▌ | 69/81 [02:41<00:27,  2.30s/it] 86%|████████▋ | 70/81 [02:44<00:25,  2.33s/it] 88%|████████▊ | 71/81 [02:46<00:23,  2.34s/it] 89%|████████▉ | 72/81 [02:49<00:21,  2.36s/it] 90%|█████████ | 73/81 [02:51<00:18,  2.37s/it] 91%|█████████▏| 74/81 [02:53<00:16,  2.37s/it] 93%|█████████▎| 75/81 [02:56<00:14,  2.36s/it] 94%|█████████▍| 76/81 [02:58<00:11,  2.36s/it] 95%|█████████▌| 77/81 [03:00<00:09,  2.33s/it] 96%|█████████▋| 78/81 [03:03<00:07,  2.35s/it] 98%|█████████▊| 79/81 [03:05<00:04,  2.36s/it] 99%|█████████▉| 80/81 [03:07<00:02,  2.35s/it]100%|██████████| 81/81 [03:10<00:00,  2.35s/it]100%|██████████| 81/81 [03:10<00:00,  2.35s/it]
Total: 5183
05/16/2025 12:07:04 - INFO - __main__ -     bleu-4 = 8.83 
05/16/2025 12:07:04 - INFO - __main__ -     ********************
05/16/2025 12:07:04 - INFO - __main__ -   Average inference time: 2.1258989881586143
05/16/2025 12:07:04 - INFO - __main__ -   Test file: ../dataset/java/test.jsonl
05/16/2025 12:07:15 - INFO - __main__ -   ********* GPU-WARM-UP ********
  0%|          | 0/172 [00:00<?, ?it/s]  1%|          | 1/172 [00:02<06:51,  2.40s/it]  1%|          | 2/172 [00:04<06:46,  2.39s/it]  2%|▏         | 3/172 [00:07<06:44,  2.39s/it]  2%|▏         | 4/172 [00:09<06:42,  2.40s/it]  3%|▎         | 5/172 [00:12<06:43,  2.41s/it]  3%|▎         | 6/172 [00:14<06:40,  2.41s/it]  4%|▍         | 7/172 [00:16<06:39,  2.42s/it]  5%|▍         | 8/172 [00:19<06:35,  2.41s/it]  5%|▌         | 9/172 [00:21<06:25,  2.37s/it]  6%|▌         | 10/172 [00:23<06:25,  2.38s/it]  6%|▋         | 11/172 [00:26<06:18,  2.35s/it]  7%|▋         | 12/172 [00:28<06:17,  2.36s/it]  8%|▊         | 13/172 [00:31<06:19,  2.39s/it]  8%|▊         | 14/172 [00:33<06:18,  2.39s/it]  9%|▊         | 15/172 [00:35<06:10,  2.36s/it]  9%|▉         | 16/172 [00:38<06:07,  2.36s/it] 10%|▉         | 17/172 [00:40<06:07,  2.37s/it] 10%|█         | 18/172 [00:42<06:06,  2.38s/it] 11%|█         | 19/172 [00:45<05:56,  2.33s/it] 12%|█▏        | 20/172 [00:47<05:57,  2.35s/it] 12%|█▏        | 21/172 [00:49<05:54,  2.35s/it] 13%|█▎        | 22/172 [00:52<05:51,  2.34s/it] 13%|█▎        | 23/172 [00:54<05:51,  2.36s/it] 14%|█▍        | 24/172 [00:56<05:49,  2.36s/it] 15%|█▍        | 25/172 [00:59<05:45,  2.35s/it] 15%|█▌        | 26/172 [01:01<05:43,  2.35s/it] 16%|█▌        | 27/172 [01:03<05:38,  2.34s/it] 16%|█▋        | 28/172 [01:06<05:32,  2.31s/it] 17%|█▋        | 29/172 [01:08<05:32,  2.33s/it] 17%|█▋        | 30/172 [01:10<05:34,  2.35s/it] 18%|█▊        | 31/172 [01:13<05:35,  2.38s/it] 19%|█▊        | 32/172 [01:15<05:34,  2.39s/it] 19%|█▉        | 33/172 [01:18<05:33,  2.40s/it] 20%|█▉        | 34/172 [01:20<05:30,  2.39s/it] 20%|██        | 35/172 [01:23<05:29,  2.41s/it] 21%|██        | 36/172 [01:25<05:17,  2.34s/it] 22%|██▏       | 37/172 [01:27<05:17,  2.35s/it] 22%|██▏       | 38/172 [01:30<05:16,  2.36s/it] 23%|██▎       | 39/172 [01:32<05:16,  2.38s/it] 23%|██▎       | 40/172 [01:34<05:14,  2.39s/it] 24%|██▍       | 41/172 [01:37<05:12,  2.39s/it] 24%|██▍       | 42/172 [01:39<05:11,  2.40s/it] 25%|██▌       | 43/172 [01:42<05:10,  2.41s/it] 26%|██▌       | 44/172 [01:44<05:03,  2.37s/it] 26%|██▌       | 45/172 [01:46<04:59,  2.36s/it] 27%|██▋       | 46/172 [01:49<05:00,  2.38s/it] 27%|██▋       | 47/172 [01:51<04:59,  2.40s/it] 28%|██▊       | 48/172 [01:53<04:57,  2.40s/it] 28%|██▊       | 49/172 [01:56<04:52,  2.38s/it] 29%|██▉       | 50/172 [01:58<04:50,  2.39s/it] 30%|██▉       | 51/172 [02:01<04:48,  2.39s/it] 30%|███       | 52/172 [02:03<04:46,  2.38s/it] 31%|███       | 53/172 [02:05<04:45,  2.40s/it] 31%|███▏      | 54/172 [02:08<04:44,  2.41s/it] 32%|███▏      | 55/172 [02:10<04:42,  2.42s/it] 33%|███▎      | 56/172 [02:13<04:39,  2.41s/it] 33%|███▎      | 57/172 [02:15<04:37,  2.41s/it] 34%|███▎      | 58/172 [02:17<04:30,  2.37s/it] 34%|███▍      | 59/172 [02:20<04:24,  2.34s/it] 35%|███▍      | 60/172 [02:22<04:25,  2.37s/it] 35%|███▌      | 61/172 [02:24<04:24,  2.39s/it] 36%|███▌      | 62/172 [02:27<04:22,  2.39s/it] 37%|███▋      | 63/172 [02:29<04:20,  2.39s/it] 37%|███▋      | 64/172 [02:32<04:18,  2.39s/it] 38%|███▊      | 65/172 [02:34<04:17,  2.41s/it] 38%|███▊      | 66/172 [02:36<04:14,  2.40s/it] 39%|███▉      | 67/172 [02:39<04:11,  2.40s/it] 40%|███▉      | 68/172 [02:41<04:09,  2.40s/it] 40%|████      | 69/172 [02:44<04:06,  2.39s/it] 41%|████      | 70/172 [02:46<04:03,  2.39s/it] 41%|████▏     | 71/172 [02:48<04:00,  2.38s/it] 42%|████▏     | 72/172 [02:51<03:56,  2.37s/it] 42%|████▏     | 73/172 [02:53<03:54,  2.37s/it] 43%|████▎     | 74/172 [02:55<03:52,  2.37s/it] 44%|████▎     | 75/172 [02:58<03:50,  2.37s/it] 44%|████▍     | 76/172 [03:00<03:47,  2.37s/it] 45%|████▍     | 77/172 [03:03<03:44,  2.37s/it] 45%|████▌     | 78/172 [03:05<03:40,  2.34s/it] 46%|████▌     | 79/172 [03:07<03:37,  2.34s/it] 47%|████▋     | 80/172 [03:10<03:35,  2.35s/it] 47%|████▋     | 81/172 [03:12<03:33,  2.35s/it] 48%|████▊     | 82/172 [03:14<03:29,  2.33s/it] 48%|████▊     | 83/172 [03:16<03:24,  2.30s/it] 49%|████▉     | 84/172 [03:19<03:24,  2.32s/it] 49%|████▉     | 85/172 [03:21<03:23,  2.34s/it] 50%|█████     | 86/172 [03:24<03:21,  2.35s/it] 51%|█████     | 87/172 [03:26<03:19,  2.35s/it] 51%|█████     | 88/172 [03:28<03:18,  2.36s/it] 52%|█████▏    | 89/172 [03:31<03:16,  2.36s/it] 52%|█████▏    | 90/172 [03:34<03:29,  2.56s/it] 53%|█████▎    | 91/172 [03:36<03:22,  2.50s/it] 53%|█████▎    | 92/172 [03:38<03:16,  2.46s/it] 54%|█████▍    | 93/172 [03:41<03:09,  2.40s/it] 55%|█████▍    | 94/172 [03:43<03:06,  2.39s/it] 55%|█████▌    | 95/172 [03:45<03:02,  2.37s/it] 56%|█████▌    | 96/172 [03:48<02:59,  2.36s/it] 56%|█████▋    | 97/172 [03:50<02:55,  2.33s/it] 57%|█████▋    | 98/172 [03:52<02:53,  2.34s/it] 58%|█████▊    | 99/172 [03:55<02:51,  2.35s/it] 58%|█████▊    | 100/172 [03:57<02:49,  2.35s/it] 59%|█████▊    | 101/172 [03:59<02:47,  2.35s/it] 59%|█████▉    | 102/172 [04:02<02:44,  2.35s/it] 60%|█████▉    | 103/172 [04:04<02:41,  2.34s/it] 60%|██████    | 104/172 [04:06<02:39,  2.35s/it] 61%|██████    | 105/172 [04:09<02:37,  2.35s/it] 62%|██████▏   | 106/172 [04:11<02:35,  2.36s/it] 62%|██████▏   | 107/172 [04:14<02:33,  2.36s/it] 63%|██████▎   | 108/172 [04:16<02:31,  2.36s/it] 63%|██████▎   | 109/172 [04:18<02:28,  2.36s/it] 64%|██████▍   | 110/172 [04:21<02:26,  2.36s/it] 65%|██████▍   | 111/172 [04:23<02:24,  2.37s/it] 65%|██████▌   | 112/172 [04:25<02:21,  2.37s/it] 66%|██████▌   | 113/172 [04:28<02:17,  2.33s/it] 66%|██████▋   | 114/172 [04:30<02:15,  2.34s/it] 67%|██████▋   | 115/172 [04:32<02:13,  2.35s/it] 67%|██████▋   | 116/172 [04:35<02:09,  2.32s/it] 68%|██████▊   | 117/172 [04:37<02:08,  2.33s/it] 69%|██████▊   | 118/172 [04:39<02:06,  2.34s/it] 69%|██████▉   | 119/172 [04:42<02:04,  2.35s/it] 70%|██████▉   | 120/172 [04:44<02:02,  2.36s/it] 70%|███████   | 121/172 [04:46<02:00,  2.36s/it] 71%|███████   | 122/172 [04:49<01:56,  2.33s/it] 72%|███████▏  | 123/172 [04:51<01:53,  2.32s/it] 72%|███████▏  | 124/172 [04:53<01:51,  2.33s/it] 73%|███████▎  | 125/172 [04:56<01:49,  2.34s/it] 73%|███████▎  | 126/172 [04:58<01:47,  2.34s/it] 74%|███████▍  | 127/172 [05:00<01:45,  2.35s/it] 74%|███████▍  | 128/172 [05:03<01:43,  2.36s/it] 75%|███████▌  | 129/172 [05:05<01:41,  2.35s/it] 76%|███████▌  | 130/172 [05:08<01:39,  2.36s/it] 76%|███████▌  | 131/172 [05:10<01:36,  2.36s/it] 77%|███████▋  | 132/172 [05:12<01:34,  2.36s/it] 77%|███████▋  | 133/172 [05:14<01:29,  2.30s/it] 78%|███████▊  | 134/172 [05:17<01:27,  2.31s/it] 78%|███████▊  | 135/172 [05:19<01:25,  2.32s/it] 79%|███████▉  | 136/172 [05:21<01:23,  2.33s/it] 80%|███████▉  | 137/172 [05:24<01:21,  2.34s/it] 80%|████████  | 138/172 [05:26<01:19,  2.34s/it] 81%|████████  | 139/172 [05:28<01:17,  2.35s/it] 81%|████████▏ | 140/172 [05:31<01:14,  2.33s/it] 82%|████████▏ | 141/172 [05:33<01:12,  2.34s/it] 83%|████████▎ | 142/172 [05:35<01:10,  2.34s/it] 83%|████████▎ | 143/172 [05:38<01:07,  2.33s/it] 84%|████████▎ | 144/172 [05:40<01:05,  2.33s/it] 84%|████████▍ | 145/172 [05:42<01:01,  2.29s/it] 85%|████████▍ | 146/172 [05:45<00:59,  2.31s/it] 85%|████████▌ | 147/172 [05:47<00:56,  2.26s/it] 86%|████████▌ | 148/172 [05:49<00:55,  2.29s/it] 87%|████████▋ | 149/172 [05:52<00:53,  2.32s/it] 87%|████████▋ | 150/172 [05:54<00:51,  2.33s/it] 88%|████████▊ | 151/172 [05:56<00:48,  2.31s/it] 88%|████████▊ | 152/172 [05:58<00:45,  2.28s/it] 89%|████████▉ | 153/172 [06:01<00:43,  2.28s/it] 90%|████████▉ | 154/172 [06:03<00:41,  2.30s/it] 90%|█████████ | 155/172 [06:05<00:39,  2.30s/it] 91%|█████████ | 156/172 [06:08<00:37,  2.32s/it] 91%|█████████▏| 157/172 [06:10<00:34,  2.33s/it] 92%|█████████▏| 158/172 [06:12<00:32,  2.34s/it] 92%|█████████▏| 159/172 [06:15<00:30,  2.35s/it] 93%|█████████▎| 160/172 [06:17<00:28,  2.35s/it] 94%|█████████▎| 161/172 [06:19<00:25,  2.35s/it] 94%|█████████▍| 162/172 [06:22<00:23,  2.36s/it] 95%|█████████▍| 163/172 [06:24<00:21,  2.36s/it] 95%|█████████▌| 164/172 [06:27<00:18,  2.36s/it] 96%|█████████▌| 165/172 [06:29<00:16,  2.36s/it] 97%|█████████▋| 166/172 [06:31<00:14,  2.35s/it] 97%|█████████▋| 167/172 [06:34<00:11,  2.34s/it] 98%|█████████▊| 168/172 [06:36<00:09,  2.34s/it] 98%|█████████▊| 169/172 [06:38<00:07,  2.34s/it] 99%|█████████▉| 170/172 [06:41<00:04,  2.35s/it] 99%|█████████▉| 171/172 [06:43<00:02,  2.31s/it]100%|██████████| 172/172 [06:43<00:00,  1.81s/it]100%|██████████| 172/172 [06:43<00:00,  2.35s/it]
Total: 10955
05/16/2025 12:14:22 - INFO - __main__ -     bleu-4 = 19.89 
05/16/2025 12:14:22 - INFO - __main__ -     ********************
05/16/2025 12:14:22 - INFO - __main__ -   Average inference time: 2.1138756275177
